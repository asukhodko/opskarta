# opskarta

**opskarta** — открытый формат данных (YAML/JSON) для *оперативной карты программы/проекта*: единого артефакта, в котором менеджер фиксирует свою актуальную интерпретацию структуры работ и зависимостей, а затем генерирует из неё сколько угодно представлений (Gantt, граф зависимостей, чек‑листы, отчёты, и т.д.).

Ключевая идея простая и слегка дерзкая:  
**«источник истины» — не Jira, не Confluence и не “в голове”, а твой версионируемый файл‑план**.  
Все остальные системы остаются *системами деталей и исполнения* и могут меняться без разрушения общей картины.

---

## Зачем это вообще

В больших программах у менеджера есть несколько одновременно болезненных проблем:

- *Единая оперативная картинка* расползается по десяткам досок, эпиков, вордиков и чатов.
- «Структура программы» постоянно кочует: сегодня Jira, завтра Linear, послезавтра — новая таксономия, а долгоживущая логика остаётся у тебя в голове.
- В “боевой” системе деталей сложно хранить черновики и наброски: «ещё не готово заводить эпик», «надо прикинуть трек», «есть гипотеза про зависимость» — и это теряется.
- На вопрос «а что вообще происходит?» приходится отвечать из памяти, а память — штука творческая.

**opskarta** решает это так:

1) Ты ведёшь *один* структурный план (как код) в репозитории.  
2) Из этого плана генеришь любые представления под разные разговоры и аудитории.  
3) Jira/YouTrack/etc остаются местом, где живут детали задач (комменты, исполнители, переписки, статусы), но **не** “единственной правдой о структуре программы”.

---

## Что является целью opskarta

opskarta стремится быть **лёгким форматом данных + набором инструментов вокруг него**.

### Цели

- **Единая карта работ**: дерево (структура) + граф (зависимости) + атрибуты планирования (даты/длительности/статусы).
- **Много представлений из одной модели**: разные Gantt‑вьюхи, графы, отчёты, “срезы” по трекам/командам/релизам.
- **Plan-as-code**: диффы, история, ветки, черновики, эксперименты, быстрый refactor структуры.
- **Независимость от систем деталей**: возможность “пережить” миграцию между Jira/Linear/… без амнезии.
- **Открытая спецификация**: чтобы сторонние инструменты могли читать/писать этот формат (рендеры, синхронизаторы, аналитика, LLM‑помощники).

---

## Чего opskarta сознательно НЕ делает (non-goals)

Чтобы не превратиться в очередной «комбайн, который решит все менеджерские проблемы сразу», opskarta **не берётся** за следующее:

- Не заменяет Jira/Linear/YouTrack:  
  нет комментариев, workflow‑правил, SLA, досок, прав доступа, спринтов, автоматизаций и т.п.
- Не является системой исполнения:  
  opskarta — *карта и модель*, а не “где команда живёт каждый день”.
- Не навязывает методологию (Scrum/Kanban/SAFe/…):  
  формат должен переживать любые школы менеджерской магии.
- Не пытается «вычислить истину» автоматически:  
  план — это *твоя интерпретация* (и это нормально).
- Не решает ресурсное планирование и финансовое моделирование “в лоб” (люди, ставки, бюджеты) — можно расширять, но это не ядро.
- Не обещает идеально точных прогнозов:  
  прогноз — это модель, модель — это допущения.

---

## Как это устроено

В базовом варианте есть два файла:

- **План** (`*.plan.yaml`) — *единая модель*: узлы работ, иерархия, зависимости, статусы, заметки.
- **Представления** (`*.views.yaml`) — *как смотреть на план*: какие срезы делать, какие узлы показывать, в каких “полосах/лейнах”, какие форматы рендерить.

Такой split важен: **модель одна, представлений много**.

---

## Мини‑пример

`examples/hello.plan.yaml`:

```yaml
version: 1

meta:
  id: hello-upgrade
  title: "Пример: обновление Git-сервиса"

statuses:
  not_started: { label: "Не начато",     color: "#9ca3af" }
  in_progress: { label: "В работе",      color: "#0ea5e9" }
  done:        { label: "Готово",        color: "#22c55e" }
  blocked:     { label: "Заблокировано", color: "#fecaca" }

nodes:
  root:
    title: "Обновление Git-сервиса"
    kind: summary
    status: in_progress

  prep:
    title: "Подготовка"
    kind: phase
    parent: root
    start: 2026-02-01
    duration: 10d
    status: in_progress

  rollout:
    title: "Раскатка"
    kind: phase
    parent: root
    after: [prep]
    duration: 5d
    status: not_started

  switch:
    title: "Переключение трафика"
    kind: task
    parent: rollout
    after: [rollout]
    duration: 1d
    status: not_started
    notes: |
      Критичный шаг. Нужен план отката.
```

`examples/hello.views.yaml`:

```yaml
version: 1
project: hello-upgrade

gantt_views:
  overview:
    title: "Hello Upgrade — Overview"
    excludes: ["weekends"]

    lanes:
      main:
        title: "Основной поток"
        nodes: [prep, rollout, switch]
```

---

## Инструменты (в этом репозитории)

Этот репозиторий содержит:

- **Спецификацию формата** (docs/spec)
- **JSON Schema** для валидации (schemas)
- **Референсный CLI** (пока минимальный):  
  - `opskarta validate` — проверить план/вьюхи  
  - `opskarta render gantt` — сгенерировать Mermaid Gantt по представлению

> Важно: референсный CLI — не “единственный правильный”. Он нужен как старт и как эталон того, как трактовать поля спецификации.

---

## Быстрый старт

```bash
# 1) Клонируй репозиторий и поставь CLI в editable-режиме
python -m venv .venv
source .venv/bin/activate
pip install -e ".[dev]"

# 2) Проверь пример
opskarta validate examples/hello.plan.yaml examples/hello.views.yaml

# 3) Сгенерируй Mermaid Gantt (в stdout)
opskarta render gantt --plan examples/hello.plan.yaml --views examples/hello.views.yaml --view overview
```

---

## Документация

- Метод и мотивация: `docs/method.md`
- Спецификация формата: `docs/spec/`
- Как расширять формат (extension fields): `docs/spec/050-extensibility.md`

---

## Лицензия

Apache License 2.0 — см. файл `LICENSE`.

---

## Вклад

PR‑ы и идеи приветствуются, но проект намеренно держится «лёгким».  
Правило простое: **формат — ядро, инструменты — плагины**.

См. `CONTRIBUTING.md`.
